"""
Adversarial training
"""

import copy
import numpy as np

import torch
import torch.nn as nn

from adversarialbox.attacks import PGD20
from adversarialbox.utils import truncated_normal



def adv_train(X, Y,model, criterion, adversary):
    model_cp = copy.deepcopy(model)
    for p in model_cp.parameters():
        p.requires_grad = False
    model_cp.eval()
    
    adversary.model = model_cp

    X_adv = adversary.perturb(X.numpy(),Y)

    return torch.from_numpy(X_adv)

